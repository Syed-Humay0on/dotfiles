[plugin]
open_file = "/usr/bin/nvim"

[opener]
edit = [
    { run = 'nvim "$@"', block = true, desc = "Edit with Neovim" }
]
# 2. Image opener using feh
view_img = [
    { run = 'feh "$@"', detach = true, desc = "View with Feh" }
]

# 3. PDF opener using Zathura
view_pdf = [
    { run = 'zathura "$@"', detach = true, desc = "View with Zathura" }
]
# --- Extractors ---
extract_zip = [
    { run = 'mkdir -p "${1%.*}" && unzip "$1" -d "${1%.*}"', desc = "Extract Zip", notify = true }
]
extract_tar = [
    # Using the exact logic from your tldr: tar xf ... --directory ...
    { run = 'bash -c "DIR=\"${1%%.tar*}\"; mkdir -p \"$DIR\" && tar xf \"$1\" --directory \"$DIR\""', desc = "Extract Tarball", notify = true }
]
extract_7z = [
    { run = 'mkdir -p "${1%.*}" && 7z x "$1" -o"${1%.*}"', desc = "Extract 7z", notify = true }
]
play_video = [
    { run = 'mpv "$@"', orphan = true, for = "unix", desc = "Play with MPV" }
]

[open]
rules = [
# Archives (zip, 7z, tar.gz)
{ name = "*.tar.gz", use = "extract_tar" },
    { name = "*.tar.xz", use = "extract_tar" },
    { name = "*.tar",    use = "extract_tar" },
    { name = "*.tgz",    use = "extract_tar" },
    { name = "*.zip",    use = "extract_zip" },
    { name = "*.7z",     use = "extract_7z" },

    # Video and Audio
    { mime = "{video,audio}/*", use = "play_video" },
    
    # PDF and Documents
    { name = "*.pdf", use = "view_pdf" },
    
    # Images
    { mime = "image/*", use = "view_img" },
    
    # Fallback for text/code
    { name = "*.txt", use = "edit" },
    { mime = "text/*", use = "edit" },
    { mime = "application/json", use = "edit" },
]

